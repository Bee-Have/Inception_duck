# user			www;
# worker_processes	auto;
# error_log		/dev/stdout warn;
# pid				/var/run/nginx/nginx.pid;

# events {
# 	worker_connections 1024;
# }

# http {
# 	sendfile_max_chunk 16m;
# 	include /etc/nginx/mime.types;
# 	default_type application/octet-stream;
# 	sendfile on;
# 	access_log /dev/stdout;
# 	keepalive_timeout 3000;
# 	proxy_set_header Host $http_host;
# 	proxy_set_header X-Forwarded-Host $http_host;

	server {
		listen 80;
		listen [::]:80;

		server_name amarini-.42.fr;

		return 301 https://$server_name$request_uri;
	}

	server {
		listen 443 ssl;
		listen [::]:443 ssl;

		# include snippets/snakeoil.conf;
		# ssl_certificate /etc/ssl/certs/ssl-cert-snakeoil.pem;
		# ssl_certificate_key /etc/ssl/certs/ssl-cert-snakeoil.key;
		ssl_certificate /etc/nginx/ssl/amarini-.crt;
		ssl_certificate_key /etc/nginx/ssl/amarini-.key;

		ssl_protocols TLSv1.2 TLSv1.3;

		server_name amarini-.42.fr;

		root /var/www/;
		index index.php index.html index.htm;

		autoindex on;

		location / {
			try_files $uri $uri/ = 404;
		}

		location ~ \.php$ {
			fastcgi_split_path_info ^(.+\.php)(/.+)$;
			fastcgi_pass wordpress:9000;
			fastcgi_index index.php;
			fastcgi_intercept_errors on;
			include fastcgi_params;
			fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
			fastcgi_param SCRIPT_NAME $fastcgi_script_name;
		}
	}
# }

# server {
# 	listen 8080;

# 	server_name localhost;
# 	server_tokens off;

# 	location / {
# 		return 301 https://$host$request_uri;
# 	}
# }

# server {
# 	# port to listen to from computer/vm
# 	listen 443 ssl;
# 	listen [::]:443 ssl default_server;
# 	# listen 8080;
# 	# listen [::]:8080;

# 	# ssl certificate settings (makes site safe)
# 	ssl on;
# 	# ssl_certificate /etc/nginx/ssl/amarini-.crt;
# 	# ssl_certificate_key /etc/nginx/ssl/amarini-.key;
# 	include snippets/snakeoil.conf;
# 	ssl_certificate /etc/ssl/certs/ssl-cert-snakeoil.pem;
# 	ssl_certificate_key /etc/ssl/certs/ssl-cert-snakeoil.key;
# 	# ssl_certificate etc/ssl/certs/ssl-cert-snakeoil.pem;
# 	# ssl_certificate_key /etc/ssl/private/ssl-cert-snakeoil.key;

# 	# which protocol (version) to use for ssl certificate
# 	ssl_protocols TLSv1.2 TLSv1.3;

# 	# server name
# 	server_name localhost;

# 	# where sites starts
# 	root /var/www/;
# 	index index.html index.htm index.php;
# 	autoindex on;

# 	# log everything that's happening to nginx
# 	# access_log /var/log/nginx/amariniaccess.log;
# 	# error_log /var/log/nginx/amarinierror.log;

# 	location / {
# 		try_files $uri $uri/ = 404;
# 	}

# 	# php-fpm setup between wordpress && php-fpm
# 	location ~ \.php$ {
# 		fastcgi_split_path_info ^(.+\.php)(/.+)$;
# 		fastcgi_pass wordpress:9000;
# 		fastcgi_index index.php;
# 		include fastcgi_params;
# 		fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
# 		fastcgi_param SCRIPT_NAME $fastcgi_script_name;
# 	}
# }